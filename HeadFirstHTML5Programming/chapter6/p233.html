<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <style>
    .saleItem:nth-child(2n) {
        width:400px;
        margin:5px;
        background-color:rgb(226, 226, 217);
     
    }
    .saleItem:nth-child(2n+1) {
        width:400px;
        margin:5px;
        background-color:white;
     
    }  
    </style>
    <script>
    /*
    window.onload = function() {
        var url ="http://127.0.0.1:8080/HeadFirstHTML5Programming/chapter6/sales.json";
        var request = new XMLHttpRequest();
        request.open("GET", url);
        request.onload = function() {
            if (request.status == 200) {
                updateSales(request.responseText);
            }
        }; 
        request.send(null);
    }
   
    
    function updateSales(responseText) {
        var salesDiv = document.getElementById("sales");
        //salesDiv.innerHTML = responseText;
        var sales = JSON.parse(responseText);
        for (var i = 0; i < sales.length; i++) {
            var sale = sales[i];
            var div = document.createElement("div");
            div.setAttribute("class", "saleItem");
            div.innerHTML = sale.name + " sold " + sale.sales + " gumballs ";
            salesDiv.appendChild(div);
        };
    }
     */
    window.onload = function() {
        setInterval(handleRefresh, 2000);
    };
    function handleRefresh() {
        var url ="http://gumball.wickedlysmart.com/?callback=updateSales";
        
        var newScriptElement = document.createElement("script");
        newScriptElement.setAttribute("src", url);
        newScriptElement.setAttribute("id", "jsonp");
        
        var oldScriptElement = document.getElementById("jsonp");
        var head= document.getElementsByTagName("head")[0];
        if (oldScriptElement == null) {
            head.appendChild(newScriptElement);
        } else {
            head.replaceChild(newScriptElement, oldScriptElement);
        };
    }
    function updateSales(sales) {
        var salesDiv = document.getElementById("sales");
        for (var i = 0; i < sales.length; i++) {
            var sale = sales[i];
            var div = document.createElement("div");
            div.setAttribute("class", "saleItem");
            div.innerHTML = sale.name + " sold " + sale.sales + " gumballs ";
            salesDiv.appendChild(div);
        };
    }
    </script>
</head>
<body>
    <h1> Mighty Gumball Sales</h1>
    <div id="sales">
    </div>
   <!-- <script   src="http://gumball.wickedlysmart.com/?callback=updateSales"></script>-->
</body>
</html>